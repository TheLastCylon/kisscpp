<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>KISSCPP: Standard Handlers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">KISSCPP
   </div>
   <div id="projectbrief">a C++ library for rapid application development</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Standard Handlers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Your KISSCPP derived applications, will be implementing handlers of it's own. But there are certain things that all applications need. Here is a short list of some of those things:</p>
<ul>
<li>keeping and retrieving of statistics</li>
<li>keeping, retrieving and clearing application error states.</li>
<li>The ability to adjust an applications log level, without restarting the application.</li>
<li>The ability to see a list of handlers that an application implements.</li>
</ul>
<p>KISSCPP aims to provide standardised mechanisms for all of the above, and more.</p>
<p>Here is a list of the standard handlers, currently implemented by KISSCPP.</p>
<p><em>The <b>kch</b> prefix, is shorthand for (K)iss(C)pp (H)andler. To prevent conflict between KISSCPP specific handlers and your own, do not prefix any of your custom handler identifiers with <b>kch</b>.</em></p>
<table class="doxtable">
<tr>
<th><b>Handler Id</b> </th><th><b>Purpose</b>  </th></tr>
<tr>
<td>kch-loglevel </td><td>Adjust the logging to specified levels </td></tr>
<tr>
<td>kch-handlers </td><td>shows a list of the request handlers for this application </td></tr>
<tr>
<td>kch-errstat </td><td>retrieves the application error states </td></tr>
<tr>
<td>kch-errclear </td><td>Used to marks an application error state as cleared. </td></tr>
<tr>
<td>kch-stat </td><td>retrieves the application statistics </td></tr>
</table>
<p>In order to ease the introduction to this here, we'll start with discussing the adjustment of log levels.</p>
<h2>Adjusting log level on the fly.</h2>
<p>For a discussion on what log levels are and how they are used, please see the section on logging.</p>
<table class="doxtable">
<tr>
<th align="center"><b>Handler</b> </th><th align="center"><b>Purpose</b>  </th></tr>
<tr>
<td align="center">kch-loglevel </td><td align="center">Used to set the logging level to new values, while an application is running. </td></tr>
</table>
<h3>Parameters</h3>
<table class="doxtable">
<tr>
<th align="left"><b>Parameter name</b> </th><th align="center"><b>Mandatory?</b> </th><th align="left"><b>possible values</b>  </th></tr>
<tr>
<td align="left">type </td><td align="center">Yes </td><td align="left">"debug", "info", "error" </td></tr>
<tr>
<td align="left">severity </td><td align="center">Yes </td><td align="left">"low", "normal", "high" </td></tr>
</table>
<h3>Examples</h3>
<ul>
<li>The example blow, will cause a KISSCPP application to start logging everything at all log levels, because the lowest log level has a log type of <em>debug</em>, and a severity of <em>low</em>. <div class="fragment"><div class="line">{<span class="stringliteral">&quot;kcm-cmd&quot;</span>:<span class="stringliteral">&quot;kch_loglevel&quot;</span>,<span class="stringliteral">&quot;type&quot;</span>:<span class="stringliteral">&quot;debug&quot;</span>,<span class="stringliteral">&quot;severity&quot;</span>:<span class="stringliteral">&quot;low&quot;</span>,<span class="stringliteral">&quot;kcm-client&quot;</span>:{<span class="stringliteral">&quot;id&quot;</span>:<span class="stringliteral">&quot;foo&quot;</span>,<span class="stringliteral">&quot;instance&quot;</span>:<span class="stringliteral">&quot;1&quot;</span>}}</div>
</div><!-- fragment --></li>
<li>And in the second example bellow, logging will be restricted to logs of type <em>info</em> or <em>error</em> with a severity of at least "normal". <div class="fragment"><div class="line">{<span class="stringliteral">&quot;kcm-cmd&quot;</span>:<span class="stringliteral">&quot;kch_loglevel&quot;</span>,<span class="stringliteral">&quot;type&quot;</span>:<span class="stringliteral">&quot;info&quot;</span>,<span class="stringliteral">&quot;severity&quot;</span>:<span class="stringliteral">&quot;normal&quot;</span>,<span class="stringliteral">&quot;kcm-client&quot;</span>:{<span class="stringliteral">&quot;id&quot;</span>:<span class="stringliteral">&quot;foo&quot;</span>,<span class="stringliteral">&quot;instance&quot;</span>:<span class="stringliteral">&quot;1&quot;</span>}}</div>
</div><!-- fragment --></li>
</ul>
<p>Here is an example of a bash script one can use for setting an application's log levels from the command line.</p>
<div class="fragment"><div class="line">{(.sh)}</div>
<div class="line">#!/bin/bash</div>
<div class="line">KISSCPP_HOSTNAME=<span class="stringliteral">&quot;&quot;</span></div>
<div class="line">PORT=<span class="stringliteral">&quot;&quot;</span></div>
<div class="line">LOG_TYPE=<span class="stringliteral">&quot;info&quot;</span></div>
<div class="line">LOG_SEVERITY=<span class="stringliteral">&quot;normal&quot;</span></div>
<div class="line">CLIENT_ID=<span class="stringliteral">&quot;script&quot;</span></div>
<div class="line">CLIENT_INSTANCE=<span class="stringliteral">&quot;1&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> [ -n $1 ]; then</div>
<div class="line">  KISSCPP_HOSTNAME=$1</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  echo <span class="stringliteral">&quot;You need to specify an address to send too.&quot;</span></div>
<div class="line">  exit 1</div>
<div class="line">fi</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> [ -n $2 ]; then</div>
<div class="line">  PORT=$2</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  echo <span class="stringliteral">&quot;You need to specify a port to send on.&quot;</span></div>
<div class="line">  exit 1</div>
<div class="line">fi</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> [ -n $3 ]; then LOG_TYPE=$3;        fi</div>
<div class="line"><span class="keywordflow">if</span> [ -n $4 ]; then LOG_SEVERITY=$4;    fi</div>
<div class="line"><span class="keywordflow">if</span> [ -n $5 ]; then CLIENT_ID=$5;       fi</div>
<div class="line"><span class="keywordflow">if</span> [ -n $6 ]; then CLIENT_INSTANCE=$6; fi</div>
<div class="line"></div>
<div class="line">echo <span class="stringliteral">&#39;{&quot;kcm-cmd&quot;:&quot;kch-loglevel&quot;,&quot;type&quot;:&quot;&#39;</span>$LOG_TYPE<span class="stringliteral">&#39;&quot;,&quot;severity&quot;:&quot;&#39;</span>$LOG_SEVERITY<span class="stringliteral">&#39;&quot;,&quot;kcm-client&quot;:{&quot;id&quot;:&quot;&#39;</span>$CLIENT_ID<span class="stringliteral">&#39;&quot;,&quot;instance&quot;:&quot;&#39;</span>$CLIENT_INSTANCE<span class="stringliteral">&#39;&quot;}}&#39;</span> | nc -w 2 $KISSCPP_HOSTNAME $PORT</div>
</div><!-- fragment --><p>Logging and it's implementation in KISSCPP is discussed here.</p>
<p>This is a discussion on how to change the type and severity of logs that are written by an application, while the application is running.</p>
<p>The standard handler for this is called</p>
<h2>Format</h2>
<p>After much investigation and debate, JSON was yet again selected as the preferred format. In the case of configuration files, we found that INI format lacks the ability for nested records and XML quickly becomes an unreadable mess. The only down side we have identified with the use of JSON as a configuration file format, was it's lack of native support for comments. This is a shortcoming we are more than willing to live with.</p>
<h2>Reserved identifiers</h2>
<p>The following are reserved identifiers, for use in configuration files: Note: The prefix of <b>kcc</b> is shorthand for (K)iss(C)pp (C)onfiguration.</p>
<p><em>The <b>kcc</b> prefix, is shorthand for (K)iss(C)pp (C)onfiguration. To prevent conflict between KISSCPP specific configuration and your own application data, do not prefix any of your custom configuration variables with <b>kcc</b>.</em></p>
<table class="doxtable">
<tr>
<th><b>Identifier</b> </th><th><b>Description</b>  </th></tr>
<tr>
<td>kcc-server.address </td><td>the hostname or ip address of the server. </td></tr>
<tr>
<td>kcc-server.port </td><td>the port of the server. </td></tr>
<tr>
<td>kcc-stats.gather-period </td><td>Seconds between gathering statistics for historic purposes. </td></tr>
<tr>
<td>kcc-stats.history-length </td><td>Number of historic stats gatherings to keep. </td></tr>
<tr>
<td>kcc-log-level.type </td><td>The default type limitation on logs. </td></tr>
<tr>
<td>kcc-log-level.severity </td><td>The default severity limitation on logs. </td></tr>
<tr>
<td>kcc-white-list </td><td>A root node containing data regarding white list communications. More detail available <a href="md_white_listed_communications.html">here</a>. </td></tr>
</table>
<h2>Configuration file naming standard</h2>
<p>KISSCPP applications will have configuration files named as follows:</p>
<div class="fragment"><div class="line">&lt;application-<span class="keywordtype">id</span>&gt;.&lt;application-instance-<span class="keywordtype">id</span> or <span class="stringliteral">&quot;common&quot;</span>&gt;.kcppcfg</div>
</div><!-- fragment --><p>i.e. An application with the id "foo", being executed with an instance identifier of "bar" will look for a configuration file named:</p>
<div class="fragment"><div class="line">foo.bar.kcppcfg</div>
</div><!-- fragment --><p>This file must contain configuration data that is specific to the <b>foo</b> application running as instance <b>bar</b>.</p>
<p>There is however, a mechanism for allowing shared configuration to exist in a single file. This is known as the common-configuration file. This file will have the instance id portion of the file name, replaced by the string "common".</p>
<p>i.e. An application with the id <b>foo</b>, being executed with an instance identifier of <b>bar</b> will look for shared configuration details in a file named.</p>
<div class="fragment"><div class="line">foo.common.kcppcfg</div>
</div><!-- fragment --><h2>Configuration file location</h2>
<p>Due to the fact that KISSCPP is a library meant for large systems consisting of interdependent processes, we did have to standardize on most aspects of the configuration files. The control we can give you, is based around a holistic approach, and the fact that the developer is not the only one that needs to be considered here. System administrators and support personnel also need to have a sane standard to work with.</p>
<p>As such, the following decision were made:</p>
<ol type="1">
<li>Only the root path for configuration files, will be under user control. i.e. You can specify nothing more than the path under which KISSCPP will search for the following:<ul>
<li>A sub-directory with a name matching the application-id.</li>
<li>Files contained in that sub-directory, that match the file naming standard discussed above.</li>
</ul>
</li>
<li>A mechanism for environment separation will be available. i.e. You have the ability to keep environment specific files separated from each other. This mechanism is provided through the <b>KCPP_EXEC_ENV</b> environment variable</li>
</ol>
<p>The configuration file path, is constructed in one of three ways:</p>
<ul>
<li>Where <b>KCPP_CFG_ROOT</b> and <b>KCPP_EXEC_ENV</b> are used: $KCPP_CFG_ROOT/&lt;application-id&gt;/$KCPP_EXEC_ENV/&lt;application-configuration-file-name&gt;</li>
<li>Where only <b>KCPP_CFG_ROOT</b> is used: $KCPP_CFG_ROOT/&lt;application-id&gt;/&lt;application-configuration-file-name&gt;</li>
<li>Developers can override any setting of <b>KCPP_CFG_ROOT</b> by specifying the path at the time of instantiating the Server class.</li>
</ul>
<p>That means, when you have a KISSCPP application with the name <b>foo</b> and you start instance <b>bar</b> of it, while having <b>KCPP_CFG_ROOT</b> set to <b>/put/configurations/here</b></p>
<p>Your application will look in:</p>
<ul>
<li>/put/configurations/here/foo</li>
<li>for a files named<ul>
<li>foo.common.kcppcfg and</li>
<li>foo.bar.kcppcfg</li>
</ul>
</li>
</ul>
<p>Meaning that the full path to these files will be:</p>
<ul>
<li>/put/configurations/here/foo/foo.common.kcppcfg and</li>
<li>/put/configurations/here/foo/foo.bar.kcppcfg</li>
</ul>
<p>Now, with all of that in play, you can still set the <b>KCPP_EXEC_ENV</b> environment variable. This comes in handy when you have differing configurations for your test, quality control and production environments.</p>
<p>Thus, with all the above and <b>KCPP_EXEC_ENV</b> set too: <b>live</b></p>
<p>Your application will look in:</p>
<ul>
<li>/put/configurations/here/foo/live</li>
<li>for files named<ul>
<li>foo.common.kcppcfg and</li>
<li>foo.bar.kcppcfg</li>
</ul>
</li>
</ul>
<p>Meaning that the full path to these files will be:</p>
<ul>
<li>/put/configurations/here/foo/live/foo.common.kcppcfg and</li>
<li>/put/configurations/here/foo/live/foo.bar.kcppcfg</li>
</ul>
<h2>Example.</h2>
<p>Ok, let's say you have an application called <b>ninjarules</b> and you need to run three instances of that application on the same machine.</p>
<p>To keep things sane, you set <b>KCPP_CFG_ROOT</b> too <b>/my/central/config</b>. You also know that your test and your live environments will have different configurations so you plan on setting <b>KCPP_EXEC_ENV</b> to <b>live</b> and <b>test</b> respectively, so that you can avoid having to maintain both sets of configurations in one file.</p>
<p>You further decide, although you can use any arbitrary string as an instance identifier, that you'll stick to the simple numbers 1, 2 and 3, for your various instances.</p>
<p>Your application will therefore look in these directories:</p>
<ul>
<li>In the <b>live</b> environment: /my/central/config/ninjarules/live</li>
<li>In the <b>test</b> environment: /my/central/config/ninjarules/test</li>
</ul>
<p>For files named:</p>
<ul>
<li>ninjarules.common.kcppcfg,</li>
<li>ninjarules.1.kcppcfg,</li>
<li>ninjarules.2.kcppcfg and</li>
<li>ninjarules.3.kcppcfg</li>
</ul>
<p>There are some things that will be common for all instances of <b>ninjarules</b>, so you'll want to keep them in the common configuration. Here's an example of that: </p>
<div class="fragment"><div class="line">{(ninjarules.common.json)}</div>
<div class="line">{</div>
<div class="line">  <span class="stringliteral">&quot;kcc-stats&quot;</span>     : {</div>
<div class="line">    <span class="stringliteral">&quot;gather-period&quot;</span>  : <span class="stringliteral">&quot;300&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;history-length&quot;</span> : <span class="stringliteral">&quot;12&quot;</span></div>
<div class="line">  },</div>
<div class="line"></div>
<div class="line">  <span class="stringliteral">&quot;kcc-log-level&quot;</span> : {</div>
<div class="line">    <span class="stringliteral">&quot;type&quot;</span>           : <span class="stringliteral">&quot;info&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;severity&quot;</span>       : <span class="stringliteral">&quot;normal&quot;</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>And then of course, there will be the instance level configuration files: </p>
<div class="fragment"><div class="line">{(ninjarules.1.kcppcfg)}</div>
<div class="line">{</div>
<div class="line">  <span class="stringliteral">&quot;kcc-server&quot;</span>    : {</div>
<div class="line">    <span class="stringliteral">&quot;address&quot;</span>        : <span class="stringliteral">&quot;locahost&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;port&quot;</span>           : <span class="stringliteral">&quot;9001&quot;</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line">{(ninjarules.2.kcppcfg)}</div>
<div class="line">{</div>
<div class="line">  <span class="stringliteral">&quot;kcc-server&quot;</span>    : {</div>
<div class="line">    <span class="stringliteral">&quot;address&quot;</span>        : <span class="stringliteral">&quot;locahost&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;port&quot;</span>           : <span class="stringliteral">&quot;9002&quot;</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line">{(ninjarules.3.kcppcfg)}</div>
<div class="line">{</div>
<div class="line">  <span class="stringliteral">&quot;kcc-server&quot;</span>    : {</div>
<div class="line">    <span class="stringliteral">&quot;address&quot;</span>        : <span class="stringliteral">&quot;locahost&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;port&quot;</span>           : <span class="stringliteral">&quot;9003&quot;</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 10 2015 11:05:03 for KISSCPP by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
